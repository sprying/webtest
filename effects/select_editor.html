<!DOCTYPE html>
<HTML>
<HEAD>
    <TITLE>moveToPoint Example</TITLE>
    <meta charset="utf-8">
    <script for=document event=onclick>
//        var r
//        if (window.event.srcElement.isTextEdit) {
//            r = window.event.srcElement.createTextRange();
//        }
//        else {
//            var el = window.event.srcElement.parentTextEdit;
//            r = el.createTextRange();
//        }
//
//        r.moveToPoint(window.event.x, window.event.y);
//        r.expand("word");
//        r.select();
    </script>
</HEAD>
<BODY>

<H1 id=myH1>Click on a word and it will highlight</H1>

<TEXTAREA cols="86" rows="10" id="editArea">
    There's text in this element too that you could click on
</TEXTAREA>
<button id="doReply">回复</button>
<script>
    var editArea = document.getElementById('editArea'),
        replyBtn = document.getElementById('doReply'),
            fns = function(e){
                editArea.focus();
                var value = editArea.value;
                editArea.value = value =  value.replace(/(^\s*)|(\s*$)/g, "");
                if(editArea.createTextRange){
                    editArea.focus();
                    var range = editArea.createTextRange();
                    range.move("character", value.length)
                    range.select();
                }else{
                    editArea.setSelectionRange(value.length,value.length);
                    editArea.focus();
                }
            };
        replyBtn.onclick = fns;

</script>

</BODY>
</HTML>